{% extends 'base.html.twig' %}

{% block title %}Your Feed - Centralinks{% endblock %}

{% block body %}
<div class="flex min-h-screen bg-[#161616] text-white">

 {{ include('feed/_sidenav.html.twig') }}
    <!-- MAIN FEED -->
    <main class="flex-1 p-10">
        <h1 class="text-3xl font-bold mb-8">Recent posts in your feed</h1>

        <div class="grid gap-6">
            {% for post in posts %}
                <div class="bg-[#1e1e1e] border border-gray-700 rounded-2xl p-6 shadow-md shadow-black/20">
                    <div class="flex items-start justify-between mb-4">
                        <div>
                            <h2 class="text-xl font-semibold text-gray-100">{{ post.title }}</h2>
                            <p class="text-sm text-gray-500">
                                Posted by u/{{ post.author }} in r/{{ post.subreddit }} • {{ post.created_utc|date('M d, Y') }}
                            </p>
                        </div>
                        {% if post.flair %}
                            <span class="bg-blue-900 text-blue-300 text-xs font-medium px-2 py-1 rounded-xl h-fit">
                                {{ post.flair }}
                            </span>
                        {% endif %}
                    </div>

                    {% if post.thumbnail %}
                        <img src="{{ post.thumbnail }}" alt="Post Image" class="w-full h-52 object-cover rounded-xl mb-4">
                    {% endif %}

                    {% if post.selftext %}
                        <p class="text-gray-300 text-sm">
                            {{ post.selftext | slice(0, 300) ~ '...' }}
                        </p>
                    {% endif %}

                    <div class="flex items-center justify-between mt-4 text-gray-500 text-sm">
                        <span>⬆️ {{ post.score }} points</span>
                        <a href="{{ post.permalink }}" target="_blank" class="underline hover:text-gray-300">
                            {{ post.num_comments }} comments
                        </a>
                    </div>
                </div>
            {% endfor %}

            {% if posts is empty %}
                <div class="bg-[#1e1e1e] border border-gray-700 rounded-xl p-6 shadow-md shadow-black/20 text-gray-300">
                    <h2 class="text-xl font-semibold mb-2">Feed is empty</h2>
                    <p>Select a category from the left to view its posts.</p>
                </div>
            {% endif %}
        </div>
    </main>

</div>
{% endblock %}
